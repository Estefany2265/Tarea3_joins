
SELECT TOP 5 B.TITLE,COUNT(HO.ORDER_ID) AS VENDIDOS
FROM ORDER_LINE OL
INNER JOIN ORDER_HISTORY HO
ON OL.ORDER_ID = HO.ORDER_ID
INNER JOIN BOOK B
ON OL.BOOK_ID = B.BOOK_ID
where HO.STATUS_ID ='1'
GROUP BY B.TITLE,HO.STATUS_ID
ORDER BY 2 DESC


SELECT C.COUNTRY_NAME,CUS.METHOD_NAME
FROM SHIPPING_METHOD SM
INNER JOIN CUST_ORDER CUS
ON SM.METHOD_ID = CUS.SHIPPING_METHOD_ID
INNER JOIN ADDRESS AD
CUS.DEST_ADDRESS_ID = AD.ADDRESS_ID
INNER JOIN COUNTRY C
AD.COUNTRY_ID = C.COUNTRY_ID

SELECT B.TITLE,OS.STATUS_VALUE,HO.ORDER_ID
FROM ORDER_LINE OL
INNER JOIN ORDER_HISTORY HO
ON OL.ORDER_ID = HO.ORDER_ID
INNER JOIN BOOK B
ON OL.BOOK_ID = B.BOOK_ID
INNER JOIN ORDER_STATUS OS
ON HO.STATUS_ID = OS.STATUS_ID
where HO.STATUS_ID ='5'


select *from book_author;
select *from author;
select *from country;-------
select *from book;
select *from book_language;
select *from CUST_ORDER;--------
select *from CUSTOMER;
select *from ORDER_LINE;
select *from PUBLISHER;
select *from SHIPPING_METHOD;-----
select *from ADDRESS_STATUS;
select *from ADDRESS;--------
select *from ORDER_HISTORY;
select *from CUSTOMER_ADDRESS;
select *from ORDER_STATUS;


SELECT C.FIRST_NAME,C.LAST_NAME,B.TITLE,OS.STATUS_VALUE
FROM ORDER_LINE OL
INNER JOIN ORDER_HISTORY HO
ON OL.ORDER_ID = HO.ORDER_ID
INNER JOIN BOOK B
ON OL.BOOK_ID = B.BOOK_ID
INNER JOIN ORDER_STATUS OS
ON HO.STATUS_ID = OS.STATUS_ID
INNER JOIN CUST_ORDER CO
ON HO.ORDER_ID = CO.ORDER_ID
INNER JOIN CUSTOMER C
ON CO.CUSTOMER_ID = C.CUSTOMER_ID
where HO.STATUS_ID ='6'


SELECT B.TITLE,OS.STATUS_VALUE,COUNT(OL.ORDER_ID) AS CANTIDAD_ENTREGADA
FROM ORDER_LINE OL
INNER JOIN ORDER_HISTORY HO
ON OL.ORDER_ID = HO.ORDER_ID
INNER JOIN BOOK B
ON OL.BOOK_ID = B.BOOK_ID
INNER JOIN ORDER_STATUS OS
ON HO.STATUS_ID = OS.STATUS_ID
where HO.STATUS_ID ='1'
GROUP BY B.TITLE,OS.STATUS_VALUE
ORDER BY 3 DESC


SELECT C.FIRST_NAME,C.LAST_NAME,OS.STATUS_VALUE,COUNT(OL.ORDER_ID) AS CANTIDAD_ENTREGADA
FROM ORDER_LINE OL
INNER JOIN ORDER_HISTORY HO
ON OL.ORDER_ID = HO.ORDER_ID
INNER JOIN BOOK B
ON OL.BOOK_ID = B.BOOK_ID
INNER JOIN ORDER_STATUS OS
ON HO.STATUS_ID = OS.STATUS_ID
INNER JOIN CUST_ORDER CO
ON HO.ORDER_ID = CO.ORDER_ID
INNER JOIN CUSTOMER C
ON CO.CUSTOMER_ID = C.CUSTOMER_ID
where HO.STATUS_ID ='1'
GROUP BY C.FIRST_NAME,C.LAST_NAME,OS.STATUS_VALUE
ORDER BY CANTIDAD_ENTREGADA DESC


SELECT B.TITLE,COUNT(HO.ORDER_ID) AS VENDIDOS,HO.STATUS_DATE
FROM ORDER_LINE OL
INNER JOIN ORDER_HISTORY HO
ON OL.ORDER_ID = HO.ORDER_ID
INNER JOIN BOOK B
ON OL.BOOK_ID = B.BOOK_ID
where HO.STATUS_ID ='1'
GROUP BY B.TITLE,HO.STATUS_ID,HO.STATUS_DATE
ORDER BY 2 DESC
